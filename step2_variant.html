<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<style>
    body {
        margin: 0;
        font-family: "Inter", sans-serif;
        background: #f7f7f7;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    /* ---------- TOP BAR ---------- */
    .topbar {
        width: 100%;
        background: white;
        height: 90px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 40px;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 50;
    }

    .topbar-left {
        display: flex;
        align-items: center;
        gap: 14px;
        width: 250px;
    }

    .topbar-left img { height: 55px; }

    .brand-text {
        font-weight: 700;
        font-size: 18px;
        line-height: 1.2;
    }

    .brand-tagline {
        font-size: 14px;
        opacity: 0.7;
        font-weight: 500;
    }

    .topbar-center {
        flex: 1;
        text-align: center;
        font-size: 28px;
        font-weight: 800;
    }

    .topbar-right { width: 250px; }

    /* ----------- MAIN CONTENT ----------- */
    .scroll-area {
        flex: 1;
        overflow-y: auto;
        padding: 130px 0 140px;
        display: flex;
        justify-content: center;
    }

   .content-card {
    width: 1100px;
    background: white;
    padding: 40px 60px 80px;
    border-radius: 22px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    margin-bottom: 40px;
    min-height: 2500px; /* чтобы влезали 3 ряда плиток */
}

    /* ----- GRID (2 in row) ------ */
    .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 28px;
        margin-top: 20px;
    }

    .tile {
        border: 2px solid #ddd;
        border-radius: 16px;
        padding: 16px;
        cursor: pointer;
        transition: 0.2s;
        text-align: center;
        background: #fafafa;
    }

    .tile:hover {
        border-color: #333;
        transform: translateY(-3px);
    }

    .tile.selected {
        border-color: #4A5F3A;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
    }

    .tile img {
    width: 100%;
    height: 420px;   /* ≈ +50% визуально */
    object-fit: cover;
    border-radius: 14px;
    margin-bottom: 14px;
}


    .tile-title {
        font-size: 22px;
        font-weight: 700;
        margin-bottom: 6px;
    }
.design-title {
    text-align: center;
    font-size: 26px;
    font-weight: 700;
    margin-bottom: 10px;
}

.design-subtitle {
    text-align: center;
    font-size: 15px;
    opacity: 0.75;
    margin-bottom: 25px;
}

    .tip-icon {
        font-size: 20px;
        width: 26px;
        height: 26px;
        border-radius: 50%;
        background: #eee;
        border: 1px solid #ccc;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
    }

    /* ---- FULLSCREEN CENTERED TOOLTIP ---- */
/* ---- FULLSCREEN CENTERED TOOLTIP ---- */
/* ---- FULLSCREEN CENTERED TEXT TOOLTIP ---- */
.tooltip-bubble {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);

    width: 380px;
    max-width: 90vw;

    background: white;
    padding: 22px;
    border-radius: 14px;
    border: 1px solid #ddd;
    box-shadow: 0 8px 25px rgba(0,0,0,0.20);

    z-index: 9999;

    display: none;
    opacity: 0;
    transition: opacity 0.25s ease;

    font-size: 18px;
    line-height: 1.35;
    font-weight: 500;
}

.tooltip-bubble.show {
    display: block;
    opacity: 1;
}

/* затемнение фона */
.tooltip-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.35);
    display: none;
    z-index: 9998;
}


    /* ---------- BOTTOM BAR ---------- */
    .bottombar {
        width: 100%;
        height: 110px;
        background: white;
        box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
        position: fixed;
        bottom: 0;
        left: 0;
        z-index: 50;
        padding: 10px 40px 0;
    }

    .bottom-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 50px;
    }

    .bottom-btn {
        padding: 12px 26px;
        background: #111;
        color: white;
        border-radius: 14px;
        font-size: 20px;
        font-weight: 600;
        cursor: pointer;
    }

    .bottom-btn.disabled {
        opacity: 0.3;
        pointer-events: none;
    }
#nextBtn {
    margin-right: 120px;
}
    .bottom-price {
        font-size: 22px;
        font-weight: 700;
    }

    .progressbar {
        width: 100%;
        height: 6px;
        background: #e5e5e5;
        border-radius: 4px;
        margin-top: 10px;
        overflow: hidden;
    }

    .progressbar-fill {
        height: 100%;
        width: 30%;
        background: #4A5F3A;
    }

</style>



<body>

<!-- TOPBAR -->
<div class="topbar">
    <div class="topbar-left">
        <img src="img/LOGO.png">
        <div class="brand-text">
            Accent Wall Calculator<br>
            <span class="brand-tagline">Modern Design • Professional Installation</span>
        </div>
    </div>

    <div class="topbar-center">CHOOSE DESIGN VARIANT</div>

    <div class="topbar-right"></div>
</div>


<!-- MAIN CONTENT -->
<div class="scroll-area">
<div class="content-card">

<div id="designTitle" class="design-title"></div>

    <div id="variantGrid" class="grid"></div>

</div>
</div>


<!-- BOTTOM BAR -->
<div class="bottombar">
    <div class="bottom-row">
        <div id="backBtn" class="bottom-btn" onclick="history.back()">Back</div>

        <div id="bottomPrice" class="bottom-price">$0</div>

        <div id="nextBtn" class="bottom-btn disabled" onclick="goNext()">Continue</div>
    </div>

    <div class="progressbar">
        <div class="progressbar-fill"></div>
    </div>
</div>


<script src="pricing-config.js"></script>
<!-- TOOLTIP ELEMENTS — ДОЛЖНЫ БЫТЬ ТУТ --++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>
<!-- TOOLTIP ELEMENTS -->
<div id="tooltipBackdrop" class="tooltip-backdrop"></div>

<div id="tooltipBox" class="tooltip-bubble">
    <div id="tooltipText"></div>
</div>
<script>
/* ---------- DATA FROM PREVIOUS STEPS ---------- */
const area = parseFloat(localStorage.getItem("wallArea"));
const heightLevel = parseInt(localStorage.getItem("heightLevel"), 10);
let zoneLevel = parseInt(localStorage.getItem("zoneLevel"), 10);
if (isNaN(zoneLevel)) zoneLevel = 0;

const designKey = localStorage.getItem("selectedDesign");
/* ---------- INITIAL PRICE FROM STEP 2 ---------- */
const storedPrice = parseFloat(localStorage.getItem("currentPrice"));

if (!isNaN(storedPrice)) {
    document.getElementById("bottomPrice").textContent =
        "$" + storedPrice.toFixed(0);
}

if (!designKey || !area || isNaN(heightLevel)) {
    alert("Calculation data missing. Please restart calculator.");
}

/* ---------- BASE DATA FROM CONFIG ---------- */
const baseRate = DESIGN_BASE_RATE[designKey];
const minPrice = DESIGN_MIN_PRICE[designKey];
const heightCoef = HEIGHT_COEF[heightLevel];

/* ---------- TITLES ---------- */
const designTitles = {
    board_batten: "Board & Batten",
    modern_geometric: "Modern Geometric",
    slat_shiplap: "Slat Wall / Shiplap",
    herringbone: "Herringbone / Chevron",
    custom: "Custom Design"
};

document.getElementById("designTitle").innerHTML = `
    <div class="design-title">${designTitles[designKey]}</div>
    <div class="design-subtitle">Choose a variant for your accent wall</div>
`;

/* ---------- VARIANT DATA ---------- */
const designMap = {
    board_batten: {
        variants: [
            { img: "variant_bb1.jpg", title: "Classic Vertical Rhythm", tip: "Clean vertical panels with a balanced, timeless look." },
            { img: "variant_bb2.jpg", title: "Upper Accent Panel", tip: "Traditional board & batten with an emphasized upper section." },
            { img: "variant_bb3.jpg", title: "Multi-Level Grid", tip: "Detailed layout with multiple horizontal divisions." }
        ]
    },
    modern_geometric: {
        variants: [
            { img: "variant_mg1.jpg", title: "Diagonal Flow", tip: "Dynamic diagonal panels." },
            { img: "variant_mg2.jpg", title: "Cross Geometry", tip: "Intersecting diagonal lines." },
            { img: "variant_mg3.jpg", title: "Vertical Pulse", tip: "Vertical rhythmic depth." },
            { img: "variant_mg4.jpg", title: "Falling Lines", tip: "Asymmetric vertical drops." },
            { img: "variant_mg5.jpg", title: "Woven Grid", tip: "Interlaced geometric pattern." },
            { img: "variant_mg6.jpg", title: "Diamond Matrix", tip: "Repeating diamond geometry." },
            { img: "variant_mg7.jpg", title: "Classic Panels Remix", tip: "Traditional panel rhythm reimagined." },
            { img: "variant_mg8.jpg", title: "Chevron Focus", tip: "Bold chevron-centered composition." }
        ]
    },
    slat_shiplap: {
        variants: [
            { img: "variant_slat1.jpg", title: "Vertical Slat Wall", tip: "Clean vertical slats." },
            { img: "variant_slat2.jpg", title: "Horizontal Shiplap", tip: "Classic horizontal boards." },
            { img: "variant_slat3.jpg", title: "Angled Slat Accent", tip: "Diagonal slat layout." }
        ]
    },
    herringbone: {
        variants: [
            { img: "variant_hc1.jpg", title: "Herringbone Classic", tip: "Traditional herringbone layout." },
            { img: "variant_hc2.jpg", title: "Chevron Line Pattern", tip: "Clean chevron geometry." },
            { img: "variant_hc3.jpg", title: "Chevron Statement", tip: "Bold chevron composition." }
        ]
    }
};

/* ---------- RENDER VARIANTS ---------- */
const grid = document.getElementById("variantGrid");
let selectedIndex = null;

designMap[designKey].variants.forEach((v, index) => {
    const tile = document.createElement("div");
    tile.className = "tile";

    tile.innerHTML = `
    <img src="./img/${v.img}">
    <div class="tile-title">${v.title}</div>
    <div class="tip-icon"
         onclick="event.stopPropagation(); showTooltip('${v.tip}')">?</div>
`;




    tile.onclick = () => selectTile(index, tile);
    grid.appendChild(tile);
});

/* ---------- SELECT VARIANT ---------- */
function selectTile(index, tile) {
    selectedIndex = index;

    document.querySelectorAll(".tile").forEach((t, i) => {
        t.classList.toggle("selected", i === index);
    });

    const offset =
        DESIGN_VARIANT_RATE_OFFSET[designKey]?.[index] || 0;

    const newRate = baseRate + offset;
    const designPrice =
        Math.max(area * newRate, minPrice) * heightCoef;

    const zipSurcharge =
        calculateZipSurcharge(area, zoneLevel);

    const finalPrice = designPrice + zipSurcharge;

    document.getElementById("bottomPrice").textContent =
        "$" + finalPrice.toFixed(0);

    document.getElementById("nextBtn").classList.remove("disabled");

    localStorage.setItem("selectedVariantIndex", index);
    localStorage.setItem("currentPrice", finalPrice.toFixed(2));
localStorage.setItem("selectedVariantName", designMap[designKey].variants[index].title);
const variantTitle = tile.querySelector(".tile-title").textContent.trim();

localStorage.setItem("selectedVariantIndex", index);
localStorage.setItem("selectedVariantName", variantTitle); // можно оставить
localStorage.setItem("variant", variantTitle);             // ← ВАЖНО



}

/* ---------- CONTINUE ---------- */
function goNext() {
    if (selectedIndex === null) return;

    const SKIP_STEP_3 = ["slat_shiplap", "herringbone"];

    const nextPage = SKIP_STEP_3.includes(designKey)
        ? "step4.html"
        : "step3.html";

    const variantName =
        localStorage.getItem("selectedVariantName") || "";

    const url =
        `${nextPage}?variant=${encodeURIComponent(variantName)}`;

    window.location.href = url;
}

/* ---------- TOOLTIP LOGIC ---------- */
const tooltipBackdrop = document.getElementById("tooltipBackdrop");
const tooltipBox = document.getElementById("tooltipBox");
const tooltipText = document.getElementById("tooltipText");

if (!tooltipBackdrop || !tooltipBox || !tooltipText) {
    console.error("Tooltip elements missing in DOM");
}


function showTooltip(text) {
    tooltipText.textContent = text;
    tooltipBackdrop.style.display = "block";
    tooltipBox.classList.add("show");
}

tooltipBackdrop.onclick = () => {
    tooltipBackdrop.style.display = "none";
    tooltipBox.classList.remove("show");
};

</script>

 



</body>
</html>
