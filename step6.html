<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accent Wall ‚Äì Step 6</title>

<style>
    body {
        margin: 0;
        font-family: "Inter", sans-serif;
        background: #f7f7f7;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    /* ---------- TOP BAR ---------- */
    .topbar {
        width: 100%;
        background: white;
        height: 90px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 40px;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 50;
    }

    .topbar-left {
        display: flex;
        align-items: center;
        gap: 14px;
        width: 250px;
    }

    .topbar-left img {
        height: 55px;
    }

    .brand-text {
        font-weight: 700;
        font-size: 18px;
        line-height: 1.2;
    }

    .brand-tagline {
        font-size: 14px;
        opacity: 0.7;
        font-weight: 500;
    }

    .topbar-center {
        flex: 1;
        text-align: center;
        font-size: 28px;
        font-weight: 800;
    }

    .topbar-right {
        width: 250px;
        text-align: right;
    }

    /* ---------- MAIN CONTENT ---------- */
    .scroll-area {
        flex: 1;
        overflow-y: auto;
        padding: 130px 0 140px;
        display: flex;
        justify-content: center;
    }

    .content-card {
        width: 1000px;
        background: white;
        padding: 40px 60px 80px;
        border-radius: 22px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        margin-bottom: 40px;
        min-height: 1600px; /* –±–æ–ª—å—à–µ –≤—ã—Å–æ—Ç–∞, —á—Ç–æ–±—ã –≤—Å—ë –≤–ª–µ–∑–∞–ª–æ */
    }

    .section-title {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 18px;
    }

    .summary-layout {
        display: grid;
        grid-template-columns: 2fr 1.4fr;
        gap: 32px;
        margin-bottom: 30px;
        align-items: flex-start;
    }

    .summary-box {
        border: 1px solid #e0e0e0;
        border-radius: 16px;
        padding: 20px 24px;
        background: #fafafa;
    }

    .summary-row {
        display: flex;
        justify-content: space-between;
        padding: 5px 0;
        border-bottom: 1px dashed #e1e1e1;
        font-size: 15px;
    }

    .summary-row:last-child {
        border-bottom: none;
    }

    .summary-label {
        font-weight: 600;
        color: #555;
        margin-right: 10px;
    }

    .summary-value {
        text-align: right;
        color: #222;
        font-weight: 500;
    }

    .price-box {
        border-radius: 16px;
        border: 1px solid #e0e0e0;
        padding: 22px 24px;
        background: #f6f8f4;
    }

    .price-line-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 6px;
    }

    .price-value {
        font-size: 26px;
        font-weight: 800;
        margin-bottom: 14px;
    }

    .install-line {
        font-size: 15px;
        font-weight: 500;
        margin-top: 4px;
    }

    /* ---------- CTA BUTTONS ---------- */
    .primary-btn,
    .secondary-btn,
    .outline-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 26px;
        border-radius: 14px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        border: none;
        text-decoration: none;
    }

    .primary-btn {
        background: #111;
        color: white;
    }

    .secondary-btn {
        background: #4A5F3A;
        color: white;
    }

    .outline-btn {
        background: transparent;
        border: 1px solid #444;
        color: #222;
    }

    .primary-btn.disabled,
    .secondary-btn.disabled {
        opacity: 0.35;
        pointer-events: none;
    }

    .cta-centered {
        text-align: center;
        margin: 24px 0;
    }

    .big-cta {
        padding: 14px 32px;
        border-radius: 18px;
        font-size: 19px;
        font-weight: 700;
    }

    

    /* ---------- SECTIONS BELOW SUMMARY ---------- */
    .question-block {
        text-align: center;
        margin-top: 30px;
        margin-bottom: 10px;
        font-size: 20px;
        font-weight: 600;
    }

    .small-note {
        text-align: center;
        font-size: 14px;
        opacity: 0.8;
        margin-top: 4px;
    }

    .choice-buttons {
        display: flex;
        justify-content: center;
        gap: 18px;
        margin-top: 12px;
        margin-bottom: 8px;
    }

    .pill-btn {
        padding: 10px 26px;
        border-radius: 999px;
        border: 1px solid #ccc;
        background: #f5f5f5;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        min-width: 120px;
        text-align: center;
    }

    .pill-btn.selected {
        border-color: #111;
        background: #111;
        color: white;
    }

    /* Email section */
    .flow-section {
        max-width: 520px;
        margin: 30px auto 0;
        text-align: center;
    }

    .flow-section h3 {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 6px;
    }

    .flow-section p {
        margin: 0 0 10px;
        font-size: 15px;
        opacity: 0.85;
    }

    .text-input {
        width: 100%;
        padding: 11px 13px;
        border-radius: 10px;
        border: 1px solid #ccc;
        font-size: 15px;
        font-family: inherit;
        box-sizing: border-box;
    }

    .helper-text {
        font-size: 13px;
        opacity: 0.75;
        margin-top: 4px;
        text-align: left;
    }

    /* Communication section */
    .comm-options {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin-top: 10px;
    }

    .comm-btn {
        padding: 8px 22px;
        border-radius: 999px;
        border: 1px solid #ccc;
        background: #f7f7f7;
        cursor: pointer;
        font-size: 15px;
        font-weight: 600;
    }

    .comm-btn.selected {
        background: #111;
        color: white;
        border-color: #111;
    }

    .phone-wrapper {
        margin-top: 15px;
        text-align: left;
    }

    .phone-wrapper label {
        font-size: 14px;
        font-weight: 600;
        display: block;
        margin-bottom: 4px;
    }

    .status-message {
        text-align: center;
        margin-top: 12px;
        font-size: 14px;
    }

    .status-ok {
        color: #2d7a2d;
    }

    .status-error {
        color: #b42626;
    }

    /* Another wall section */
    .another-wrapper {
        margin-top: 28px;
        border-top: 1px dashed #ddd;
        padding-top: 18px;
    }

    /* ---------- BOTTOM BAR ---------- */
    .bottombar {
        width: 100%;
        height: 90px;
        background: white;
        box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
        position: fixed;
        bottom: 0;
        left: 0;
        z-index: 50;
        padding: 10px 40px 0;
    }

    .bottom-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 50px;
    }

    .bottom-links {
        display: flex;
        gap: 14px;
    }

    .bottom-link-btn {
        font-size: 14px;
        padding: 6px 14px;
        border-radius: 999px;
        border: 1px solid #ccc;
        background: #fafafa;
        cursor: pointer;
    }
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
    <div class="topbar-left">
        <img src="img/LOGO.png" alt="Logo">
        <div class="brand-text">
            Accent Wall Calculator<br>
            <span class="brand-tagline">Modern Design ‚Ä¢ Professional Installation</span>
        </div>
    </div>

    <div class="topbar-center">SUMMARY & BOOKING</div>

    <div class="topbar-right"></div>
</div>

<!-- MAIN CONTENT -->
<div class="scroll-area">
    <div class="content-card">

        <div class="section-title">Your Accent Wall Summary</div>

        <div class="summary-layout">
            <!-- LEFT: SUMMARY LIST -->
            <div class="summary-box">
<div class="summary-row">
    <div class="summary-label">Order ID</div>
    <div class="summary-value" id="sumOrderId">‚Äî</div>
</div>

                <div class="summary-row">
                    <div class="summary-label">Design</div>
                    <div class="summary-value" id="sumDesign">‚Äî</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">Variant</div>
                    <div class="summary-value" id="sumVariant">‚Äî</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">Preparation</div>
                    <div class="summary-value" id="sumPrep">‚Äî</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">Finish</div>
                    <div class="summary-value" id="sumFinish">‚Äî</div>
                </div>

                <div class="summary-row" id="rowPrimaryColor">
                    <div class="summary-label">Primary color</div>
                    <div class="summary-value" id="sumColorPrimary">‚Äî</div>
                </div>

                <div class="summary-row" id="rowSecondaryColor">
                    <div class="summary-label">Secondary color</div>
                    <div class="summary-value" id="sumColorSecondary">‚Äî</div>
                </div>

                <div class="summary-row">
                    <div class="summary-label">Wall area</div>
                    <div class="summary-value" id="sumArea">‚Äî</div>
                </div>

                <div class="summary-row">
                    <div class="summary-label">Width √ó Height</div>
                    <div class="summary-value" id="sumSize">‚Äî</div>
                </div>

                <div class="summary-row">
                    <div class="summary-label">ZIP code</div>
                    <div class="summary-value" id="sumZip">‚Äî</div>
                </div>
            </div>

            <!-- RIGHT: PRICE / DATE / DURATION -->
            <div class="price-box">
                <div class="price-line-title">Total price</div>
                <div class="price-value" id="priceBox">$0.00</div>

                <div class="install-line" id="installDate">
                    Estimated installation date: Calculating‚Ä¶
                </div>
                <div class="install-line" id="durationBox">
                    Estimated installation duration: Calculating‚Ä¶
                </div>
            </div>
        </div>

        <!-- HOW IT WORKS BUTTON -->
        <div class="cta-centered">
            <button class="secondary-btn big-cta" id="howBtn">How it works</button>
        </div>

        <!-- CONTINUE QUESTION -->
        <div class="question-block">
            Would you like to continue with your order?
        </div>
        <div class="choice-buttons">
            <div class="pill-btn" id="btnContinueYes">Yes</div>
            <div class="pill-btn" id="btnContinueNo">No</div>
        </div>
        <div class="small-note" id="continueNote">
            You‚Äôre not committing to anything yet ‚Äî this just helps us prepare your quote.
        </div>

        <div class="status-message" id="thankMessage" style="display:none;">
            Thank you! Your configuration is saved. You can close this page at any time.
        </div>

        <!-- EMAIL SECTION (hidden initially) -->
        <div class="flow-section" id="emailSection" style="display:none;">
            <h3>1.Please enter your email</h3>
            <p>We‚Äôll send you a detailed quote and next steps.</p>
            <input id="emailInput" type="email" class="text-input" placeholder="your@email.com">
            <div class="helper-text">
                We will never share your email with third parties.
            </div>
        </div>

        <!-- COMMUNICATION SECTION -->
        <div class="flow-section" id="commSection" style="display:none;">
            <h3>2.How would you prefer to communicate?</h3>
            <p>You can choose email, phone, or both ‚Äî whatever works best for you.</p>


            <div class="comm-options">
                <button type="button" id="commEmail" class="comm-btn selected">By Email</button>
                <button type="button" id="commPhone" class="comm-btn">By Phone</button>
            </div>

            <div class="phone-wrapper" id="phoneWrapper" style="display:none;">
                <label for="phoneInput">Phone number</label>
                <input id="phoneInput" type="tel" class="text-input" placeholder="+1 (555) 123-4567">
            </div>
<h3>3.How can we address you?</h3>
<p>Please enter your name</p>
<input id="nameInput" type="text" class="text-input" placeholder="Your name">
<div class="helper-text">
    This will be used in your estimate and future communication.
</div>

<br>
            <div class="cta-centered" style="margin-top:20px;">
                <button id="confirmCommBtn" class="primary-btn big-cta" style="display:none;">
    Confirm 
</button>

            </div>

            <div class="status-message" id="crmStatus"></div>
        </div>

        <!-- SEND INVOICE BUTTON (after CRM OK) -->
        <div class="cta-centered" id="invoiceSection" style="display:none;">
<div class="status-message status-ok" id="invoiceStatus" style="display:none;">
    Your estimate has been sent to your email. Please check your inbox.
</div>

            <button id="sendInvoiceBtn" class="secondary-btn big-cta">
                Send invoice to email
            </button>
            <div class="small-note">
                You‚Äôll receive a PDF-style estimate with all selected options.
            </div>
        </div>

        <!-- ANOTHER WALL SECTION -->
        <div class="flow-section another-wrapper" id="anotherSection" style="display:none;">
            <h3>Would you like to calculate another wall?</h3>
            <div class="choice-buttons">
                <div class="pill-btn" id="btnAnotherYes">Yes</div>
                <div class="pill-btn" id="btnAnotherNo">No</div>
            </div>
            <div class="small-note">
                If you choose ‚ÄúYes‚Äù, we‚Äôll take you back to the first step and keep your contact details.
            </div>
        </div>

    </div>
</div>

<!-- BOTTOM BAR -->
<div class="bottombar">
    <div class="bottom-row">
        <div class="bottom-links">
           <button class="bottom-link-btn" onclick="window.location.href='faq.html'">
    Frequently Asked Questions
</button>

<button class="bottom-link-btn" onclick="window.location.href='contact.html'">
    Contact Us
</button>

        </div>

        <!-- –ú–µ—Å—Ç–æ –ø–æ–¥ —á—Ç–æ-—Ç–æ –µ—â—ë, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è -->
        <div></div>
    </div>
</div>

<!-- HOW IT WORKS MODAL -->
<!-- HOW IT WORKS MODAL -->
<div id="howBackdrop" style="
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.35);
    display: none;
    z-index: 9998;
"></div>

<div id="howBox" style="
    position: fixed;
    top: calc(60% + 20px);
    left: 50%;
    transform: translate(-50%, -50%);
    width: 520px;
    max-width: 94vw;
    background: white;
    padding: 24px;
    border-radius: 18px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.28);
    display: none;
    opacity: 0;
    transition: opacity 0.25s ease;
    z-index: 9999;
">
    <div style="
        font-size:26px;
        font-weight:800;
        text-align:center;
        margin-bottom:18px;
    ">
        How this process works
    </div>

    <div style="white-space: pre-line; font-size: 16px; line-height: 2;">
1. You need to fill out this form. IT IS VERY SIMPLE.
If you have any questions while completing the form, just click Contact Us on the first page.
At the end of the process, you will receive an ACCURATE price and an estimated installation date based on our team‚Äôs current workload.

2. Our manager will contact you to discuss the details of your order and prepare the contract.

3. You will make a deposit, and we will begin preparing for the project.

4. We will complete the installation professionally and with high quality.
    </div>

    <img src="img/how_it_works_placeholder.jpg" alt="How it works" style="width:100%; border-radius:12px; margin-top:10px;">

    <div style="text-align:right; margin-top:12px;">
        <button id="howCloseBtn" style="
            padding: 10px 22px;
            border-radius:14px;
            background:white;
            border:1px solid #444;
            cursor:pointer;
        ">Close</button>
    </div>
</div>


<script>
/* ========== 1. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–• ========== */
const urlParams = new URLSearchParams(window.location.search);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ —Å–æ–∑–¥–∞–µ–º ID –∑–∞–∫–∞–∑–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
function generateOrderId() {
    return "ORD-" + Date.now();
}

const storedOrderId = generateOrderId();

const collected = {
client_name: "",
    orderId: storedOrderId, // –¢–µ–ø–µ—Ä—å ID —Ç–æ—á–Ω–æ –µ—Å—Ç—å –∑–¥–µ—Å—å
    design: urlParams.get("design") || "",
    variant: localStorage.getItem("selectedVariantName") || urlParams.get("variant") || "",
    prep: urlParams.get("prep") || "",
    finish: urlParams.get("finish") || "",
    paint_mode: urlParams.get("paint_mode") || "",
    color_primary: urlParams.get("color_primary") || "",
    color_secondary: urlParams.get("color_secondary") || "",
    area: parseFloat(urlParams.get("area") || "0"),
    width: localStorage.getItem("wallWidth") || urlParams.get("width") || "",
    height: localStorage.getItem("wallHeight") || urlParams.get("height") || "",
    zip: localStorage.getItem("zip") || urlParams.get("zip") || "",
    price: parseFloat(urlParams.get("price") || "0"),
    email: "",
    phone: "",
    method: "",
    installDateISO: "",
    installDateText: "",
    installDuration: 0
};

/* ========== 2. –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê (SUMMARY) ========== */
function mapPaintMode(mode) {
    switch (mode) {
        case "one": return "Paint ‚Äî one color";
        case "multi": return "Paint ‚Äî multiple colors";
        case "partial": return "Paint ‚Äî partial colors";
        case "wood_paint": return "Solid wood + paint";
        case "wood": return "Solid wood (no paint)";
        default: return mode || "‚Äî";
    }
}

function initSummary() {
    document.getElementById("sumOrderId").textContent = collected.orderId;
    document.getElementById("sumDesign").textContent = collected.design || "‚Äî";
    document.getElementById("sumVariant").textContent = collected.variant || "‚Äî";
    document.getElementById("sumPrep").textContent = collected.prep || "‚Äî";
    document.getElementById("sumFinish").textContent = mapPaintMode(collected.paint_mode);

    const rowPrimary = document.getElementById("rowPrimaryColor");
    const rowSecondary = document.getElementById("rowSecondaryColor");

    if (collected.paint_mode === "wood") {
        rowPrimary.style.display = "none";
        rowSecondary.style.display = "none";
    } else {
        if (collected.color_primary && collected.color_primary !== "null") {
            document.getElementById("sumColorPrimary").textContent = collected.color_primary;
        } else { rowPrimary.style.display = "none"; }

        if (collected.color_secondary && collected.color_secondary !== "null") {
            document.getElementById("sumColorSecondary").textContent = collected.color_secondary;
        } else { rowSecondary.style.display = "none"; }
    }

    document.getElementById("sumArea").textContent = collected.area ? collected.area.toFixed(1) + " sq.ft" : "‚Äî";
    if (collected.width && collected.height) {
        document.getElementById("sumSize").textContent = collected.width + " ft √ó " + collected.height + " ft";
    } else { document.getElementById("sumSize").textContent = "‚Äî"; }

    document.getElementById("sumZip").textContent = collected.zip || "‚Äî";
    document.getElementById("priceBox").textContent = "$" + collected.price.toFixed(2);
}

/* ========== 3. –õ–û–ì–ò–ö–ê –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê ========== */
const howBtn = document.getElementById("howBtn");
const howBackdrop = document.getElementById("howBackdrop");
const howBox = document.getElementById("howBox");
const howCloseBtn = document.getElementById("howCloseBtn");

function openHow() {
    howBackdrop.style.display = "block";
    howBox.style.display = "block";
    setTimeout(() => howBox.style.opacity = "1", 10);
}
function closeHow() {
    howBox.style.opacity = "0";
    setTimeout(() => {
        howBox.style.display = "none";
        howBackdrop.style.display = "none";
    }, 220);
}
howBtn.onclick = openHow;
howCloseBtn.onclick = closeHow;
howBackdrop.onclick = closeHow;

/* ========== 4. –ó–ê–ü–†–û–° –î–ê–¢–´ –£–°–¢–ê–ù–û–í–ö–ò (SLOT) ========== */
async function findInstallSlot() {
    const installDateEl = document.getElementById("installDate");
    const durationEl = document.getElementById("durationBox");

    // 1Ô∏è‚É£ —Å—á–∏—Ç–∞–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –û–î–ò–ù —Ä–∞–∑
    collected.installDuration = Math.max(
        1,
        Math.ceil(collected.price / 800)
    );

    try {
        const response = await fetch(
            "https://wallartacwllc.app.n8n.cloud/webhook/accentwall/slot",
            {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    zip: collected.zip,
                    area: collected.area,
                    design: collected.design,
                    variant: collected.variant,
                    prep: collected.prep,
                    price: collected.price,
                    width: collected.width,
                    height: collected.height,
                    installDuration: collected.installDuration // ‚Üê –í–ê–ñ–ù–û
                })
            }
        );

        const data = await response.json();

        collected.installDateISO = data.installDateISO || "";
        collected.installDateText = data.installDateText || "";

        if (data.installDuration) {
            collected.installDuration = data.installDuration;
        }

        installDateEl.textContent =
            "Estimated installation date: " +
            (collected.installDateText || "Manager will confirm");

        durationEl.textContent =
            "Estimated installation duration: " +
            collected.installDuration +
            " day(s)";

    } catch (err) {
        console.error("Slot error:", err);
        installDateEl.textContent =
            "Estimated installation date: Manager will confirm";
    }
}


/* ========== 5. –û–¢–ü–†–ê–í–ö–ê –í CRM ========== */
let crmSent = false;

async function sendOrderToCRM(extraPayload = {}) {
const nameVal = document.getElementById("nameInput").value.trim();
    const emailVal = document.getElementById("emailInput").value.trim();
    const phoneVal = document.getElementById("phoneInput").value.trim();

    // –°–û–ë–ò–†–ê–ï–ú –ü–ê–ö–ï–¢ –î–ê–ù–ù–´–•
    const payload = {


        orderId: collected.orderId, // –í–û–¢ –≠–¢–û–ô –°–¢–†–û–ö–ò –£ –í–ê–° –ù–ï –ë–´–õ–û

client_name: document.getElementById("nameInput").value.trim(),
        design: collected.design,
        variant: collected.variant,
        prep: collected.prep,
        finish: collected.finish,
        paint_mode: collected.paint_mode,
        color_primary: collected.color_primary,
        color_secondary: collected.color_secondary,
        area: collected.area,
        width: collected.width,
        height: collected.height,
        zip: collected.zip,
        price: collected.price,
        email: emailVal,
        phone: phoneVal,
        method: collected.method,
        installDateISO: collected.installDateISO,
        installDateText: collected.installDateText,
        installDuration: collected.installDuration,
        source: "accentwall_calculator",
        ...extraPayload
    };

    console.log("üöÄ FINAL PAYLOAD:", payload);

    try {
        const response = await fetch("https://wallartacwllc.app.n8n.cloud/webhook/accentwall/order", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        });

        if (!response.ok) throw new Error("Server error");

        crmStatus.textContent = "Your request has been sent! We'll contact you soon.";
        crmStatus.className = "status-message status-ok";
        crmSent = true;

        document.getElementById("invoiceSection").style.display = "block";
        document.getElementById("anotherSection").style.display = "block";
    } catch (err) {
        console.error("CRM Error:", err);
        crmStatus.textContent = "Error sending. Please try again.";
        crmStatus.className = "status-message status-error";
    }
}

/* ========== 6. –õ–û–ì–ò–ö–ê –ö–ù–û–ü–û–ö –ò –ü–û–õ–ï–ô ========== */
const emailInput = document.getElementById("emailInput");
const commSection = document.getElementById("commSection");
const phoneWrapper = document.getElementById("phoneWrapper");
const nameInput = document.getElementById("nameInput");
const confirmBtn = document.getElementById("confirmCommBtn");
const crmStatus = document.getElementById("crmStatus");



// –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
document.getElementById("btnContinueYes").onclick = () => {
    document.getElementById("btnContinueYes").classList.add("selected");
    document.getElementById("btnContinueNo").classList.remove("selected");
    document.getElementById("emailSection").style.display = "block";
};

document.getElementById("btnContinueNo").onclick = () => {
    document.getElementById("btnContinueNo").classList.add("selected");
    document.getElementById("btnContinueYes").classList.remove("selected");
    document.getElementById("thankMessage").style.display = "block";
    document.getElementById("anotherSection").style.display = "block";
};

emailInput.addEventListener("input", () => {
    if (emailInput.value.includes("@") && emailInput.value.includes(".")) {
        commSection.style.display = "block";
    }
});

nameInput.addEventListener("input", () => {
    if (nameInput.value.trim().length > 0) {
        confirmBtn.style.display = "inline-flex";
    } else {
        confirmBtn.style.display = "none";
    }
});


let emailActive = true;
let phoneActive = false;

document.getElementById("commEmail").onclick = function() {
    emailActive = !emailActive;
    this.classList.toggle("selected", emailActive);
};

document.getElementById("commPhone").onclick = function() {
    phoneActive = !phoneActive;
    this.classList.toggle("selected", phoneActive);
    phoneWrapper.style.display = phoneActive ? "block" : "none";
};

document.getElementById("confirmCommBtn").onclick = () => {
    const methods = [];
    if (emailActive) methods.push("email");
    if (phoneActive) methods.push("phone");
    collected.method = methods.join(", ");

    // üîë –í–û–¢ –≠–¢–û–ì–û –ù–ï –ë–´–õ–û
    collected.client_name = document.getElementById("nameInput").value.trim();

    if (crmSent) return;
    sendOrderToCRM();
};


document.getElementById("sendInvoiceBtn").onclick = async () => {
const payload = {
  orderId: collected.orderId,
  // üîë –í–û–¢ –≠–¢–ê –°–¢–†–û–ö–ê
  client_name: collected.client_name,
  email: document.getElementById("emailInput").value.trim(),

  design: collected.design,
  variant: collected.variant,
  prep: collected.prep,

  // üîë –í–ê–ñ–ù–û: –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø–æ–ª—è –Ω—É–∂–Ω—ã –¥–ª—è PDF
  paint_mode: collected.paint_mode,
  color_primary: collected.color_primary,
  color_secondary: collected.color_secondary,

  area: collected.area,
  width: collected.width,
  height: collected.height,
  zip: collected.zip,
  price: collected.price,

  installDateText: collected.installDateText,
  installDuration: collected.installDuration,

  source: "accentwall_calculator"
};


    console.log("üìß INVOICE PAYLOAD:", payload);

    await fetch(
        "https://wallartacwllc.app.n8n.cloud/webhook/accentwall/estimate",
        {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        }
    );
document.getElementById("invoiceStatus").style.display = "block";
document.getElementById("sendInvoiceBtn").classList.add("disabled");

   };


document.getElementById("btnAnotherYes").onclick = () => { window.location.href = "index.html"; };
document.getElementById("btnAnotherNo").onclick = () => {
    document.getElementById("crmStatus").textContent = "Thank you! Project details saved.";
};

/* –ó–ê–ü–£–°–ö */
window.addEventListener("DOMContentLoaded", () => {
    initSummary();
    findInstallSlot();
});
</script>

</body>
</html>

